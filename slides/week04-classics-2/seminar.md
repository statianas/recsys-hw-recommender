# Семинар 4. Персонализированные рекомендации

## Model-based рекомендер

На этом семинаре мы применим реализацию ALS из Spark и библиотеку LightFM 
для построения персонализированного рекомендера треков. 

### План действий
        
1. Используем ноутбук `Week4Seminar.ipynb`, для того, чтобы собрать данные для обучения рекомендера
   1. Обучаем спарковый ALS
   2. Выгружаем top-100 рекомендованных ALS треков для пользователей
   3. Загружаем сохраненные на предыдущем семинаре данные в `Dataset` LightFM
   4. Перебираем гиперпараметры модели с помощью пакета `optuna`
   5. Обучаем модель с лучшими гиперпараметрами
   6. Строим кривую обучения
   7. Смотрим на полученные эмбеддинги в tensorboard
   8. Выгружаем top-100 рекомендованных LightFM треков для пользователей
    
2. Используем рекомендер `Indexed`, который сделали на прошлом семинаре
    1. Загружаем рекомендации в новую базу `Redis`
    2. При запросе идем в базу рекомендаций и достаем рекомендации по пользователю
    3. Если рекомендаций не нашлось, то возвращаем случайные
    
3. Создаем A/B эксперимент.
    1. В `botify.experiment.Experiments` создаем эксперимент `PERSONALIZED`.
    2. В `botify.server.NextTrack` используем этот эксперимент для выбора рекомендера между `StickyArtist` и `Indexed`
       с рекомендациями, полученными с помощью LightFM и ALS.
    3. Запускаем рекомендер и симулятор.
    4. Загружаем логи сервиса на HDFS.
   
4. Используем ноутбук `Week1Seminar.ipynb` для анализа.
    1. Запускаем анализатор для эксперимента `PERSONALIZED`.

#### TimeSVD

Допустим, качество айтемов эволюционирует по времени. Модель timeSVD учитывает это в bias b_i(t). 
Предложите примеры обучаемых функций b_i(t), которые могли бы выучить эту эволюцию.